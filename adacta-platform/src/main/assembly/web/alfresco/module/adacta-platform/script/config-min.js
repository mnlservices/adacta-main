function main(){adacta.info("Create data lists...");createImportDataList("datalist_categories.csv","Categories","Rubrieken","adadl:categoryItem");createImportDataList("datalist_subjects.csv","Subjects","Onderwerpen","adadl:subjectItem");adacta.info("Create root folders in document library...");var b=adacta.getSiteDocumentLibrary();var d=adacta.makeFolders(b,"Importeer",true);var e=adacta.makeFolders(b,"Indexeer",true);var f=adacta.makeFolders(b,"Rapporten",true);d.addAspect("ada:rootImportAspect");e.addAspect("ada:rootIndexAspect");f.addAspect("ada:rootReportAspect");var c=b.childByNamePath("Dossiers");if(c!=null){c.addAspect("ada:rootDossiersAspect")}else{throw"No folder exists with name 'Dossiers'."}adacta.info("Create script rules...");createScriptRules(d,e);adacta.info("Create Adacta groups and memberships...");createGroupsAndMemberships();adacta.info("Set permissions on folders...");c.setPermission("Collaborator","GROUP_ADACTA_BEHEERDER");c.setPermission("Collaborator","GROUP_ADACTA_INVOERDER");d.setInheritsPermissions(false);d.setPermission("Collaborator","GROUP_ADACTA_INVOERDER");d.setPermission("Coordinator","GROUP_ADACTA_BEHEERDER");e.setInheritsPermissions(false);e.setPermission("Collaborator","GROUP_ADACTA_INVOERDER");e.setPermission("Coordinator","GROUP_ADACTA_BEHEERDER");f.setInheritsPermissions(false);f.setPermission("Collaborator","GROUP_ADACTA_INVOERDER");f.setPermission("Coordinator","GROUP_ADACTA_BEHEERDER");var a=createNotice();if(a!=null){a.setPermission("Collaborator","GROUP_ADACTA_BEHEERDER")}adacta.info("Done!")}function createNotice(){var c="notice.html";var a=adacta.getSiteDocumentLibrary();var b=a.childByNamePath(c);if(b==null){adacta.info("Create adacta notice...");return adacta.importClasspathFile(a,c)}return null}function createGroupsAndMemberships(){var b="GROUP_ADACTA_RAADPLEGER";var c="GROUP_ADACTA_INVOERDER";var a="GROUP_ADACTA_BEHEERDER";adacta.createGroup(b);adacta.createGroup(c);adacta.createGroup(a);adacta.addGroupToGroup("LH02P01DISF03",b);adacta.addGroupToGroup("LH02P01DISF01",c);adacta.addGroupToGroup("LH02P01DISF02",c);adacta.addGroupToGroup("LH02P01DISF06",c);adacta.addGroupToGroup("LH02P01DISF07",c);adacta.addGroupToGroup("LH02P01DISF08",c);adacta.addGroupToGroup("LH02P01DISF05",a)}function createScriptRules(e,g){adacta.removeAllRules(e);adacta.removeAllRules(g);var f=adacta.getDictionaryScripts();var b=createScript("_adacta_rule_set_type.js");var d=createScript("_adacta_mimetype_blocker.js");var a=createScript("_adacta_set_owner_scan.js");var c=createScript("_adacta_set_department_group.js");adacta.createScriptActionRule(e,b,"inbound","Set type on documents","Set ada:document type on documents.",false,true);adacta.createScriptActionRule(e,d,"inbound","Mimetype blocker","Accept only documents with mimetype application/pdf.",false,true);adacta.createScriptActionRule(e,c,"inbound","Set group permissions.","Set group permissions.",false,true);adacta.createScriptActionRule(g,b,"inbound","Set type on documents","Set ada:document type on documents.",false,true);adacta.createScriptActionRule(g,a,"inbound","Set ownership","Set ownership on documents and scanfolder.",false,true)}function createScript(c){var b=adacta.getDictionaryScripts();var a=b.childByNamePath(c.replace("_",""));if(a!=null){a.remove()}return adacta.importClasspathScript(b,c,c.replace("_",""))}function createImportDataList(d,h,a,g){var c=adacta.getSiteDocumentLibrary();var f=adacta.getDataListContainer();var e=createDataList(f,h,a,g);var b=c.createNode(d,"cm:content");adacta.putFileInputStreamInNode(b,d);adacta.importCsvToDataList(b,e);b.addAspect("sys:temporary");b.remove()}function createDataList(b,c,g,f){var e=b.childByNamePath(c);if(e!=null){e.remove()}var a=b.createNode(c,"dl:dataList");a.properties["dl:dataListItemType"]=f;a.properties["cm:name"]=c;a.save();var d=[];d["cm:title"]=g;a.addAspect("cm:titled",d);return a}main();